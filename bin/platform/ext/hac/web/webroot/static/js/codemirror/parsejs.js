var tokenizeJavaScript=function(){function a(a,b){var c=!1;while(!a.endOfLine()){var d=a.next();if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}function f(a,b){return function(c,d){var e=a,h=g(a,b,c,function(a){e=a}),i=h.type=="operator"||h.type=="keyword c"||h.type.match(/^[\[{}\(,;:]$/);return(i!=b||e!=a)&&d(f(e,i)),h}}function g(f,g,h,i){function j(){return h.next(),h.nextWhileMatches(d),{type:"number",style:"js-atom"}}function k(){h.nextWhileMatches(/[0-9]/),h.equals(".")&&(h.next(),h.nextWhileMatches(/[0-9]/));if(h.equals("e")||h.equals("E"))h.next(),h.equals("-")&&h.next(),h.nextWhileMatches(/[0-9]/);return{type:"number",style:"js-atom"}}function l(){h.nextWhileMatches(e);var a=h.get(),c=b.hasOwnProperty(a)&&b.propertyIsEnumerable(a)&&b[a];return c?{type:c.type,style:c.style,content:a}:{type:"variable",style:"js-variable",content:a}}function m(){return a(h,"/"),h.nextWhileMatches(/[gimy]/),{type:"regexp",style:"js-string"}}function n(a){var b="/*",c=a=="*";for(;;){if(h.endOfLine())break;var d=h.next();if(d=="/"&&c){b=null;break}c=d=="*"}return i(b),{type:"comment",style:"js-comment"}}function o(){return h.nextWhileMatches(c),{type:"operator",style:"js-operator"}}function p(b){var c=a(h,b);return i(c?b:null),{type:"string",style:"js-string"}}if(f=='"'||f=="'")return p(f);var q=h.next();return f=="/*"?n(q):q=='"'||q=="'"?p(q):/[\[\]{}\(\),;\:\.]/.test(q)?{type:q,style:"js-punctuation"}:q=="0"&&(h.equals("x")||h.equals("X"))?j():/[0-9]/.test(q)?k():q=="/"?h.equals("*")?(h.next(),n(q)):h.equals("/")?(a(h,null),{type:"comment",style:"js-comment"}):g?m():o():c.test(q)?o():l()}var b=function(){function a(a,b){return{type:a,style:"js-"+b}}var b=a("keyword a","keyword"),c=a("keyword b","keyword"),d=a("keyword c","keyword"),e=a("operator","keyword"),f=a("atom","atom");return{"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"in":e,"typeof":e,"instanceof":e,"var":a("var","keyword"),"function":a("function","keyword"),"catch":a("catch","keyword"),"for":a("for","keyword"),"switch":a("switch","keyword"),"case":a("case","keyword"),"default":a("default","keyword"),"true":f,"false":f,"null":f,"undefined":f,NaN:f,Infinity:f}}(),c=/[+\-*&%=<>!?|]/,d=/[0-9A-Fa-f]/,e=/[\w\$_]/;return function(a,b){return tokenizer(a,b||f(!1,!0))}}(),JSParser=Editor.Parser=function(){function c(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,d!=null&&(this.align=d),this.prev=e,this.info=f}function d(a){return function(b){var c=b&&b.charAt(0),d=a.type,e=c==d;return d=="vardef"?a.indented+4:d=="form"&&c=="{"?a.indented:d=="stat"||d=="form"?a.indented+indentUnit:a.info=="switch"&&!e?a.indented+(/^(?:case|default)\b/.test(b)?indentUnit:2*indentUnit):a.align?a.column-(e?1:0):a.indented+(e?0:indentUnit)}}function e(e,f){function p(){while(h[h.length-1].lex)h.pop()();var a=g.next();a.type=="whitespace"&&k==0&&(l=a.value.length),k+=a.value.length,a.content=="\n"&&(l=k=0,"align"in j||(j.align=!1),a.indentation=d(j));if(a.type=="whitespace"||a.type=="comment")return a;"align"in j||(j.align=!0);for(;;){m=n=!1,h.pop()(a.type,a.content);if(m)return n?a.style=n:a.type=="variable"&&y(a.content)&&(a.style="js-localvariable"),a}}function q(){var a=i,b=j,c=h.concat([]),d=g.state;return function e(e){return i=a,j=b,h=c.concat([]),k=l=0,g=tokenizeJavaScript(e,d),o}}function r(a){for(var b=a.length-1;b>=0;b--)h.push(a[b])}function s(){r(arguments),m=!0}function t(){r(arguments),m=!1}function u(a){n=a}function v(){i={prev:i,vars:{"this":!0,arguments:!0}}}function w(){i=i.prev}function x(a){i&&(u("js-variabledef"),i.vars[a]=!0)}function y(a){var b=i;while(b){if(b.vars[a])return!0;b=b.prev}return!1}function z(a,b){var d=function(){j=new c(l,k,a,null,j,b)};return d.lex=!0,d}function A(){j.type==")"&&(l=j.indented),j=j.prev}function B(a){return function b(b){b==a?s():a==";"?t():s(arguments.callee)}}function C(a){return t(E,C)}function D(a){return t(F,D)}function E(a){a=="var"?s(z("vardef"),M,B(";"),A):a=="keyword a"?s(z("form"),F,E,A):a=="keyword b"?s(z("form"),E,A):a=="{"?s(z("}"),L,A):a==";"?s():a=="function"?s(S):a=="for"?s(z("form"),B("("),z(")"),O,B(")"),A,E,A):a=="variable"?s(z("stat"),H):a=="switch"?s(z("form"),F,z("}","switch"),B("{"),L,A,A):a=="case"?s(F,B(":")):a=="default"?s(B(":")):a=="catch"?s(z("form"),v,B("("),T,B(")"),E,A,w):t(z("stat"),F,B(";"),A)}function F(b){a.hasOwnProperty(b)?s(G):b=="function"?s(S):b=="keyword c"?s(F):b=="("?s(z(")"),F,B(")"),A,G):b=="operator"?s(F):b=="["?s(z("]"),K(F,"]"),A,G):b=="{"?s(z("}"),K(J,"}"),A,G):s()}function G(a,b){a=="operator"&&/\+\+|--/.test(b)?s(G):a=="operator"?s(F):a==";"?t():a=="("?s(z(")"),K(F,")"),A,G):a=="."?s(I,G):a=="["&&s(z("]"),F,B("]"),A,G)}function H(a){a==":"?s(A,E):t(G,B(";"),A)}function I(a){a=="variable"&&(u("js-property"),s())}function J(b){b=="variable"&&u("js-property"),a.hasOwnProperty(b)&&s(B(":"),F)}function K(a,b){function c(d){d==","?s(a,c):d==b?s():s(B(b))}return function d(d){d==b?s():t(a,c)}}function L(a){a=="}"?s():t(E,L)}function M(a,b){a=="variable"?(x(b),s(N)):s()}function N(a,b){b=="="?s(F,N):a==","&&s(M)}function O(a){a=="var"?s(M,Q):a==";"?t(Q):a=="variable"?s(P):t(Q)}function P(a,b){b=="in"?s(F):s(G,Q)}function Q(a,b){a==";"?s(R):b=="in"?s(F):s(F,B(";"),R)}function R(a){a==")"?t():s(F)}function S(a,b){a=="variable"?(x(b),s(S)):a=="("&&s(z(")"),v,K(T,")"),A,E,w)}function T(a,b){a=="variable"&&(x(b),s())}var g=tokenizeJavaScript(e),h=[b?D:C],i=null,j=new c((f||0)-indentUnit,0,"block",!1),k=0,l=0,m,n,o={next:p,copy:q};return A.lex=!0,o}var a={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},b=!1;return{make:e,electricChars:"{}:",configure:function(a){a.json!=null&&(b=a.json)}}}()